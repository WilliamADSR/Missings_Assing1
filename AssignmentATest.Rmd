---
title: "Assignment A: Investigating the scope of the missingness problem"
author: "Martijn Koster"
date: "2/22/2022"
output: 
  bookdown::html_document2: default

---

<style type="text/css">

body{ /* Normal  */
      font-size: 12px;
  }
td {  /* Table  */
  font-size: 12px;
}
h1.title {
  font-size: 28px;
  }
h1 { /* Header 1 */
  font-size: 22px;
  }
h2 { /* Header 2 */
    font-size: 18px;
  }
h3 { /* Header 3 */
  font-size: 14px;
  font-family: "Times New Roman", Times, serif;
  }
code.r{ /* Code block */
    font-size: 12px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 14px;
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, comment = NA, warning = FALSE,
                      error=FALSE, results='hide',fig.keep='all')
```

---

```{r, include=FALSE}
library(mice)
library(naniar)
library(ggplot2)
library(ggpubr)
library(tidySEM)
library(dplyr)
library(VIM)
``` 

---

# Introduction{#intro}

The matter of interest for this assignment will be the impact that incomplete data (**observed data**) has on our inferences compared to the inferences we make with complete data (**true data**). To investigate the effect that missing values have on model inferences, we will build a random multiple regression model 

Therefore our research question states: what impact do missing values have on a "active" heart rate" model inference?



---

```{r}
data0 <- readRDS("~/GitHub/Missings_Assing1/incomplete_data_g1.rds") # load incomoplete
data1 <- readRDS("~/GitHub/Missings_Assing1/complete_data.rds")
```

```{r, include=FALSE}
library(mice)
library(naniar)
library(ggplot2)
library(ggpubr)
library(tidySEM)
library(dplyr)
library(VIM)
library(knitr)
library(kableExtra)
``` 

---

# Observed vs True data{#data}

In this section we will compare the observed with the true dataset. 

```{r obsData, results='hold'}
kbl(data0[1:5,], caption = "Observed Data") %>% 
  kable_classic(full_width = F, html_font = "Cambria")

kbl(data1[1:5,], caption = "True Data") %>% 
  kable_classic(full_width = F, html_font = "Cambria")
```

## Descriptives{#data1}

Obviously, neither the mean nor the variance of age, and rest changed since these has no missing values. 

The mean of active is is also almost entirely unaffected. The variance of active changed a bit in the observed data, but this difference is simply due to sampling variability (we've deleted about 40% of the observations). The missing values in active are MCAR, so we would not expect any substantial changes in the marginal distribution of active.

The mean of height is is also almost entirely unaffected. The variance of active changed a bit in the observed data, but this difference is simply due to sampling variability (we've deleted about 30% of the observations). The missing values in active are MCAR, so we would not expect any substantial changes in the marginal distribution of height.

The mean of weight is is also almost entirely unaffected. The variance of active changed a bit in the observed data, but this difference is simply due to sampling variability (we've deleted about 57% of the observations). The missing values in active are MCAR, so we would not expect any substantial changes in the marginal distribution of weight.

The mean of bmi is is also almost entirely unaffected. The variance of active changed a bit in the observed data, but this difference is simply due to sampling variability (we've deleted about 30% of the observations). The missing values in active are MCAR, so we would not expect any substantial changes in the marginal distribution of bmi.

```{r, include = FALSE}
colMeans(data0[c(1, 5:9)], na.rm =TRUE)
colMeans(data1[c(1, 5:9)], na.rm =TRUE)
sapply(data0[c(1, 5:9)], var, na.rm =TRUE)
sapply(data1[c(1, 5:9)], var)
```


```{r}
tab2 <- data.frame(
  variables <- c("Age", "Active", "Rest", "Height", 
                 "Weight", "Bmi"),
  meanObs <-  c("38.52", "92.58", "69.83", "174.50",
                "73.91", "24.11"),
  meanTrue <- c("38.52", "93.13", "69.83", "173.99",
                "73.58", "24.06"),
  varObs <- c("149.73", "383.05", "120.78", "100.66",
              "260.26", "12.91"),
  varTrue <- c("149.73", "383.04", "120.78", "105.29",
              "274.85", "13.38")
)
```


```{r des, results='hold'}
kbl(tab2, caption = "Means and variances in true and observed dataset",
    col.names = c("Variables", "$M_{obs}$", "$M_{true}$", 
                "var obs", "var true")
    ) %>% 
  kable_classic(full_width = F, html_font = "Cambria") %>% 
  footnote(
    general_title = "Note.",
    general = "obs = Observed Dataset, true = True Dataset")
```

Over here categorical data descriptions



## Correlations{#data3}

```{r corObs, results = 'show' }
dataCor <- data0
dataCor$smoke <- as.numeric(dataCor$smoke)
dataCor$sex <- as.numeric(dataCor$sex)
dataCor$intensity <- as.numeric(dataCor$intensity)
cor1 <- round(cor(dataCor, use = "pairwise.complete.obs"), 2)

kbl(cor1, caption = "Correlations of obsereved data") %>% 
  kable_classic(full_width = FALSE, html_font = "Cambria" )


```


```{r corTrue, results = 'show' }
dataCorT <- data1
dataCorT$smoke <- as.numeric(dataCorT$smoke)
dataCorT$sex <- as.numeric(dataCorT$sex)
dataCorT$intensity <- as.numeric(dataCorT$intensity)
cor2 <- round(cor(dataCorT, use = "pairwise.complete.obs"), 2)

kbl(cor2, caption = "Correlations of true data") %>% 
  kable_classic(full_width = FALSE, html_font = "Cambria" )


```


## Regression{#data4}

```{r}
fit1 <- lm(active ~ age + bmi*sex + smoke, data=data0)
fit2 <- lm(active ~ age + bmi*sex + smoke, data=data1)
coef1 <- round(fit1$coefficients, 3)
coef2 <- round(fit2$coefficients, 3)
SE1 <- round(summary(fit1)$coefficients[,2], 2)
SE2 <- round(summary(fit2)$coefficients[,2], 2)
pVal1 <- round(summary(fit1)$coefficients[,4], 3)
pVal2 <- round(summary(fit2)$coefficients[,4], 3)


tab3 <- data.frame(
  coefObs <-  coef1,
  seObs <- SE1,
  pObs <- pVal1,
  coefTrue <- coef2,
  seTrue <- SE2,
  pTrue <- pVal2)

```

```{r reg, results='hold'}

kbl(tab3, caption = "Regression analysis of True and Observed Data",
    col.names = c("$\\beta_{obs}$", "$SE_{obs}$", "$p_{obs}$",
                 "$\\beta_{true}$", "$SE_{true}$", "$p_{true}$")
    ) %>% 
  kable_classic(full_width = F, html_font = "Cambria")
```

---

# Missingness{#miss}


There are 540 missing values. 0 for age, 0 for sex, 0 for intensity, 0 for rest, 58 for smoke, 92 for height, 93 for bmi, 123 for active, and 174 for weight. moreover there are 132 completely observed rows, 15 rows with one missing value, 37 rows with two missing values, 52 rows with three missing values, 55 rows with four missing values, 15 rows with five missing values.

```{r misspat, fig.cap = "pattern of the missingness", fig.show='hold', out.width = "50%"}
md.pattern(data0)
vis_miss(data0, cluster = TRUE)
gg_miss_var(data0)
gg_miss_case(data0)
```

---

```{r, include = TRUE}
for (i in data0$weight) {
  if (is.na(data0$weight[i])) {
    i = (data0$bmi*(data0$height/100)^2) 
  }
  else {
    i = i
  }
  data0["weight"] = i
}
```

--- 



```{r}
#Function to calculate the mean difference for numeric variables
meanDif <- function(x, y) {
  mVar <- is.na(x)
  means = t.test(y ~ mVar)
  return(means)
}  

# Function to calculate the chi square for categorical variables
catDif <- function(x, y) {
  mVar = is.na(x)
  table = table(y, mVar)
  diff = chisq.test(table(y, mVar))
  return(diff)
}


# Function to visualize where the missing data is coming from
plotMiss <- function(x, y, data, xlab, ylab) {
  p <- ggplot(data,
         aes(x = x,
             y = y))+
    labs(y = ylab, x = xlab) +
    geom_miss_point()
  return(p)
}
```


```{r}
data2 = data1
data3 = data0
data2["mWeight"] = is.na(data0$weight)
data2["mHeight"] = is.na(data0$height)
data2["mBmi"] = is.na(data0$bmi)
data2["mActive"] = is.na(data0$active)
data2["mSmoke"] = is.na(data0$smoke)
data3["mWeight"] = is.na(data0$weight)
data3["mHeight"] = is.na(data0$height)
data3["mBmi"] = is.na(data0$bmi)
data3["mActive"] = is.na(data0$active)
data3["mSmoke"] = is.na(data0$smoke)
```

---

## Looking for the missingness

```{r}
# Doing t-test to calculate whether the difference of the mean in the observed and true dataset is different

outW <- meanDif(data0$weight, data1$weight) 
tOutW <- round(outW$statistic, 3) 
pOutW <- round(outW$p.value, 3) 

outH <- meanDif(data0$height, data1$height)
tOutH <- round(outH$statistic, 3)
pOutH <- round(outH$p.value, 3)

outB <- meanDif(data0$bmi, data1$bmi)
tOutB <- round(outB$statistic, 3)
pOutB <- round(outB$p.value, 3)

outA <- meanDif(data0$active, data1$active)
tOutA <- round(outA$statistic, 3)
pOutA <- round(outA$p.value, 3)

outS <- catDif(data0$smoke, data1$smoke)
cOutS <- round(outS$statistic, 3)
pOutS <- round(outS$p.value, 3)

```

weight: $t =$ `r tOutW`, $p =$ `r pOutW`

height: $t =$ `r tOutH`, $p =$ `r pOutH`

bmi: $t =$ `r tOutB`, $p =$ `r pOutB`

active: $t =$ `r tOutA`, $p =$ `r pOutA`

smoke: $x^2 =$ `r cOutS`, $p =$ `r pOutS`




```{r mnar-plot, fig.cap="comparing the distribution of the observed and true dataset"}
mnar1 <- ggplot(data2, aes(x=weight)) +
  geom_histogram(bins = 20, color = "black", fill = "white") +
  facet_grid(mWeight ~ .)
mnar2 <- ggplot(data2, aes(x=height)) +
  geom_histogram(bins = 20, color = "black", fill = "white") +
  facet_grid(mHeight ~ .)
mnar3 <- ggplot(data2, aes(x=bmi)) +
  geom_histogram(bins = 20, color = "black", fill = "white") +
  facet_grid(mBmi ~ .)
mnar4 <- ggplot(data2, aes(x=active)) +
  geom_histogram(bins = 20, color = "black", fill = "white") +
  facet_grid(mActive ~ .)

ggarrange(mnar1, mnar2, mnar3, mnar4,
  labels = c("A", "B", "C", "D"),
  ncol = 2, nrow = 2)
```


## Missingness of weight{#missW}

```{r}
mWeightMale <- data3 %>% 
  filter(sex == "male") %>% 
  pull(mWeight)

mWeightFemale <- data3 %>% 
  filter(sex == "female") %>% 
  pull(mWeight)

mWeightSmoke <- data3 %>% 
  filter(smoke == "yes") %>% 
  pull(mWeight)

mWeightNosmoke <- data3 %>% 
  filter(smoke == "no") %>% 
  pull(mWeight)

outW1 <- catDif(data3$weight, data3$sex)
cOutW1 <- round(outW1$statistic, 3)
pOutW1 <- round(outW1$p.value, 3)

outW2 <- catDif(data3$weight, data3$smoke)
cOutW2 <- round(outW2$statistic, 3)
pOutW2 <- round(outW2$p.value, 3) 

outW3 <- catDif(data0$weight, data0$intensity)
cOutW3 <- round(outW3$statistic, 3)
pOutW3 <- round(outW3$p.value, 3)

outW4 <- t.test(rest ~ mWeight, data = data3)
tOutW4 <- round(outW4$statistic, 3)
pOutW4 <- round(outW4$p.value, 3)

outW5 <- t.test(age ~ mWeight, data = data3)
tOutW5 <- round(outW5$statistic, 3)
pOutW5 <- round(outW5$p.value, 3)

outW6 <- t.test(height ~ mWeight, data = data3)
tOutW6 <- round(outW6$statistic, 3)
pOutW6 <- round(outW6$p.value, 3)

outW7 <- t.test(bmi ~ mWeight, data = data3)
tOutW7 <- round(outW7$statistic, 3)
pOutW7 <- round(outW7$p.value, 3)

outW8 <- t.test(active ~ mWeight, data = data3)
tOutW8 <- round(outW8$statistic, 3)
pOutW8 <- round(outW8$p.value, 3)

```

missing weight on sex: $x^2 =$ `r cOutW1`, $p =$ `r pOutW1`

missing weight on smoke: $x^2 =$ `r cOutW2`, $p =$ `r pOutW2`

missing weight on intensity: $x^2 =$ `r cOutW3`, $p =$ `r pOutW3`

missing weight on rest: $t =$ `r tOutW4`, $p =$ `r pOutW4`

missing weight on age: $t =$ `r tOutW5`, $p =$ `r pOutW5`

missing weight on height: $t =$ `r tOutW6`, $p =$ `r pOutW6`

missing weight on bmi: $t =$ `r tOutW7`, $p =$ `r pOutW7`

missing weight on active: $t =$ `r tOutW8`, $p =$ `r pOutW8`


```{r mar-weight, echo=FALSE, fig.show='hold', out.width = "50%", fig.cap = "Looking whether the missingness of weight is MAR"}
marWeight1 <- data3 %>% select(sex, weight) %>% spineMiss()
marWeight2 <- data3 %>% select(smoke, weight) %>% spineMiss()
marWeight3 <- data3 %>% select(intensity, weight) %>% spineMiss()
marWeight4 <- plotMiss(data3$rest, data3$weight, data3, xlab = "rest", ylab= "weight")
marWeight5 <- plotMiss(data3$age, data3$weight, data3, xlab = "age", ylab = "weight")
marWeight6 <- plotMiss(data3$height, data3$weight, data3, xlab = "height", ylab = "weight")
marWeight7 <- plotMiss(data3$bmi, data3$weight, data3, xlab = "bmi", ylab = "weight")
marWeight8 <- plotMiss(data3$active, data3$weight, data3, xlab = "active", ylab = "weight")

marWeight1
marWeight2
marWeight3
marWeight4
marWeight5
marWeight6
marWeight7
marWeight8
```



## Missingness of height{#missH}

```{r}
outH1 <- catDif(data3$height, data3$sex)
cOutH1 <- round(outW1$statistic, 3)
pOutH1 <- round(outW1$p.value, 3)

outH2 <- catDif(data3$height, data3$smoke)
cOutH2 <- round(outH2$statistic, 3)
pOutH2 <- round(outH2$p.value, 3) 

outH3 <- catDif(data0$height, data0$intensity)
cOutH3 <- round(outH3$statistic, 3)
pOutH3 <- round(outH3$p.value, 3)

outH4 <- t.test(rest ~ mHeight, data = data3)
tOutH4 <- round(outH4$statistic, 3)
pOutH4 <- round(outH4$p.value, 3)

outH5 <- t.test(age ~ mHeight, data = data3)
tOutH5 <- round(outH5$statistic, 3)
pOutH5 <- round(outH5$p.value, 3)

outH6 <- t.test(bmi ~ mHeight, data = data3)
tOutH6 <- round(outH6$statistic, 3)
pOutH6 <- round(outH6$p.value, 3)

outH7 <- t.test(active ~ mHeight, data = data3)
tOutH7 <- round(outH7$statistic, 3)
pOutH7 <- round(outH7$p.value, 3)
```

missing height on sex: $x^2 =$ `r cOutH1`, $p =$ `r pOutH1`

missing height on smoke: $x^2 =$ `r cOutH2`, $p =$ `r pOutH2`

missing height on intensity: $x^2 =$ `r cOutH3`, $p =$ `r pOutH3`

missing height on rest: $t =$ `r tOutH4`, $p =$ `r pOutH4`

missing height on age: $t =$ `r tOutH5`, $p =$ `r pOutH5`

missing height on bmi: $t =$ `r tOutH6`, $p =$ `r pOutH6`

missing height on active: $t =$ `r tOutH7`, $p =$ `r pOutH7`

```{r mar-height, echo=FALSE, fig.show='hold', out.width = "50%", fig.cap = "Looking whether the missingness of height is MAR"}
marHeight1 <- data3 %>% select(sex, height) %>% spineMiss()
marHeight2 <- data3 %>% select(smoke, height) %>% spineMiss()
marHeight3 <- data3 %>% select(intensity, height) %>% spineMiss()
marHeight4 <- plotMiss(data3$rest, data3$height, data3, xlab = "rest", ylab= "height")
marHeight5 <- plotMiss(data3$age, data3$height, data3, xlab = "age", ylab = "height")
marHeight6 <- plotMiss(data3$bmi, data3$height, data3, xlab = "bmi", ylab = "height")
marHeight7 <- plotMiss(data3$active, data3$height, data3, xlab = "active", ylab = "height")

marHeight1
marHeight2
marHeight3
marHeight4
marHeight5
marHeight6
marHeight7
```

## Missingness of Active

```{r}
outA1 <- catDif(data3$active, data3$sex)
cOutA1 <- round(outA1$statistic, 3)
pOutA1 <- round(outA1$p.value, 3)

outA2 <- catDif(data3$active, data3$smoke)
cOutA2 <- round(outA2$statistic, 3)
pOutA2 <- round(outA2$p.value, 3) 

outA3 <- catDif(data0$active, data0$intensity)
cOutA3 <- round(outA3$statistic, 3)
pOutA3 <- round(outA3$p.value, 3)

outA4 <- t.test(rest ~ mActive, data = data3)
tOutA4 <- round(outA4$statistic, 3)
pOutA4 <- round(outA4$p.value, 3)

outA5 <- t.test(age ~ mActive, data = data3)
tOutA5 <- round(outA5$statistic, 3)
pOutA5 <- round(outA5$p.value, 3)

outA6 <- t.test(height ~ mActive, data = data3)
tOutA6 <- round(outA6$statistic, 3)
pOutA6 <- round(outA6$p.value, 3)

outA7 <- t.test(bmi ~ mActive, data = data3)
tOutA7 <- round(outA7$statistic, 3)
pOutA7 <- round(outA7$p.value, 3)

outA8 <- t.test(weight ~ mActive, data = data3)
tOutA8 <- round(outA8$statistic, 3)
pOutA8 <- round(outA8$p.value, 3)
```


missing active on sex: $x^2 =$ `r cOutA1`, $p =$ `r pOutA1`

missing active on smoke: $x^2 =$ `r cOutA2`, $p =$ `r pOutA2`

missing active on intensity: $x^2 =$ `r cOutA3`, $p =$ `r pOutA3`

missing active on rest: $t =$ `r tOutA4`, $p =$ `r pOutA4`

missing active on age: $t =$ `r tOutA5`, $p =$ `r pOutA5`

missing active on height: $t =$ `r tOutA6`, $p =$ `r pOutA6`

missing active on bmi: $t =$ `r tOutA7`, $p =$ `r pOutA7`

missing active on weight: $t =$ `r tOutA8`, $p =$ `r pOutA8`



```{r mar-active, echo=FALSE, fig.show='hold', out.width = "50%", fig.cap = "Looking whether the missingness of active is MAR"}
marActive1 <- data3 %>% select(sex, active) %>% spineMiss()
marActive2 <- data3 %>% select(smoke, active) %>% spineMiss()
marActive3 <- data3 %>% select(intensity, active) %>% spineMiss()
marActive4 <- plotMiss(data3$rest, data3$active, data3, xlab = "rest", ylab= "active")
marActive5 <- plotMiss(data3$age, data3$active, data3, xlab = "age", ylab = "active")
marActive6 <- plotMiss(data3$height, data3$active, data3, xlab = "height", ylab = "active")
marActive7 <- plotMiss(data3$bmi, data3$active, data3, xlab = "bmi", ylab = "active")
marActive8 <- plotMiss(data3$weight, data3$active, data3, xlab = "weight", ylab = "active")

marActive1
marActive2
marActive3
marActive4
marActive5
marActive6
marActive7
marActive8
```


## Missingness of Bmi{#missB}


```{r}
outB1 <- catDif(data3$bmi, data3$sex)
cOutB1 <- round(outB1$statistic, 3)
pOutB1 <- round(outB1$p.value, 3)

outB2 <- catDif(data3$bmi, data3$smoke)
cOutB2 <- round(outB2$statistic, 3)
pOutB2 <- round(outB2$p.value, 3) 

outB3 <- catDif(data3$bmi, data3$intensity)
cOutB3 <- round(outB3$statistic, 3)
pOutB3 <- round(outB3$p.value, 3)

outB4 <- t.test(rest ~ mBmi, data = data3)
tOutB4 <- round(outB4$statistic, 3)
pOutB4 <- round(outB4$p.value, 3)

outB5 <- t.test(age ~ mBmi, data = data3)
tOutB5 <- round(outB5$statistic, 3)
pOutB5 <- round(outB5$p.value, 3)

outB6 <- t.test(height ~ mBmi, data = data3)
tOutB6 <- round(outB6$statistic, 3)
pOutB6 <- round(outB6$p.value, 3)

outB7 <- t.test(active ~ mBmi, data = data3)
tOutB7 <- round(outB7$statistic, 3)
pOutB7 <- round(outB7$p.value, 3)
```

missing bmi on sex: $x^2 =$ `r cOutB1`, $p =$ `r pOutB1`

missing bmi on smoke: $x^2 =$ `r cOutB2`, $p =$ `r pOutB2`

missing bmi on intensity: $x^2 =$ `r cOutB3`, $p =$ `r pOutB3`

missing bmi on rest: $t =$ `r tOutB4`, $p =$ `r pOutB4`

missing bmi on age: $t =$ `r tOutB5`, $p =$ `r pOutB5`

missing bmi on height: $t =$ `r tOutB6`, $p =$ `r pOutB6`

missing bmi on active: $t =$ `r tOutB7`, $p =$ `r pOutB7`

```{r mar-bmi, echo=FALSE, fig.show='hold', out.width = "50%", fig.cap = "Looking whether the missingness of bmi is MAR"}
marBmi1 <- data3 %>% select(sex, bmi) %>% spineMiss()
marBmi2 <- data3 %>% select(smoke, bmi) %>% spineMiss()
marBmi3 <- data3 %>% select(intensity, bmi) %>% spineMiss()
marBmi4 <- plotMiss(data3$rest, data3$bmi, data3, xlab = "rest", ylab= "bmi")
marBmi5 <- plotMiss(data3$age, data3$bmi, data3, xlab = "age", ylab = "bmi")
marBmi6 <- plotMiss(data3$height, data3$bmi, data3, xlab = "height", ylab = "bmi")
marBmi7 <- plotMiss(data3$active, data3$bmi, data3, xlab = "active", ylab = "bmi")


marBmi1
marBmi2
marBmi3
marBmi4
marBmi5
marBmi6
marBmi7
```


## Missingness of Smoke{#MissS}


```{r}
outS1 <- catDif(data3$smoke, data3$sex)
cOutS1 <- round(outS1$statistic, 3)
pOutS1 <- round(outS1$p.value, 3)

outS2 <- catDif(data3$smoke, data3$intensity)
cOutS2 <- round(outS2$statistic, 3)
pOutS2 <- round(outS2$p.value, 3) 

outS3 <- t.test(rest ~ mSmoke, data = data3)
tOutS3 <- round(outS3$statistic, 3)
pOutS3 <- round(outS3$p.value, 3)

outS4 <- t.test(age ~ mSmoke, data = data3)
tOutS4 <- round(outS4$statistic, 3)
pOutS4 <- round(outS4$p.value, 3)

outS5 <- t.test(height ~ mSmoke, data = data3)
tOutS5 <- round(outS5$statistic, 3)
pOutS5 <- round(outS5$p.value, 3)

outS6 <- t.test(bmi ~ mSmoke, data = data3)
tOutS6 <- round(outS6$statistic, 3)
pOutS6 <- round(outS6$p.value, 3)

outS7 <- t.test(weight ~ mSmoke, data = data3)
tOutS7 <- round(outS7$statistic, 3)
pOutS7 <- round(outS7$p.value, 3)

```

missing smoke on sex: $x^2 =$ `r cOutS1`, $p =$ `r pOutS1`

missing smoke on intensity: $x^2 =$ `r cOutS2`, $p =$ `r pOutS2`

missing smoke on rest: $t =$ `r tOutS3`, $p =$ `r pOutS3`

missing smoke on age: $t =$ `r tOutS4`, $p =$ `r pOutS4`

missing smoke on height: $t =$ `r tOutS5`, $p =$ `r pOutS5`

missing smoke on bmi: $t =$ `r tOutS6`, $p =$ `r pOutS6`

missing smoke on weight: $t =$ `r tOutS7`, $p =$ `r pOutS7`




```{r mar-smoke, echo=FALSE, fig.show='hold', out.width = "50%", fig.cap = "Looking whether the missingness of smoking is MAR"}
marSmoke1 <- data3 %>% select(sex, smoke) %>% spineMiss()
marSmoke2 <- data3 %>% select(intensity, smoke) %>% spineMiss()
marSmoke3 <- data3 %>% select(rest, smoke) %>% spineMiss()
marSmoke4 <- data3 %>% select(age, smoke) %>% spineMiss()
marSmoke5 <- data3 %>% select(height, smoke) %>% spineMiss()
marSmoke6 <- data3 %>% select(bmi, smoke) %>% spineMiss()
marSmoke7 <- data3 %>% select(weight, smoke) %>% spineMiss()


marSmoke1
marSmoke2
marSmoke3
marSmoke4
marSmoke5
marSmoke6
marSmoke7

```





